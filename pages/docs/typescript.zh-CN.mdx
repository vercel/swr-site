# TypeScript

SWR å¯¹äºä½¿ç”¨ TypeScript ç¼–å†™çš„ app æ˜¯å‹å¥½çš„ï¼Œå¼€ç®±å³ç”¨ï¼Œç±»å‹å®‰å…¨ã€‚

## åŸºæœ¬ç”¨æ³•

é»˜è®¤æƒ…å†µä¸‹ï¼ŒSWR ä¼šä» `key` æ¨æ–­å‡º `fetcher` çš„å‚æ•°ç±»å‹ï¼Œå› æ­¤ä½ å¯ä»¥è‡ªåŠ¨è·å¾—é¦–é€‰ç±»å‹ã€‚

### useSWR

```typescript
// `key` è¢«æ¨æ–­ä¸º `string`
useSWR('/api/user', key => {})
useSWR(() => '/api/user', key => {})

// `key` å°†è¢«æ¨æ–­ä¸º { a: string; b: { c: string; d: number } }
useSWR({ a: '1', b: { c: '3', d: 2 } }, key => {})
useSWR(() => { a: '1', b: { c: '3', d: 2 } }, key => {})

// `arg0` å°†è¢«æ¨æ–­ä¸º string.  `arg1` å°†è¢«æ¨æ–­ä¸º number
useSWR(['user', 8], (arg0, arg1) => {})
useSWR(() => ['user', 8], (arg0, arg1) => {})
```

ä½ è¿˜å¯ä»¥æ˜¾å¼åœ°æŒ‡å®š `key` å’Œ `fetcher` å‚æ•°çš„ç±»å‹ã€‚

```typescript
import useSWR, { Key, Fetcher } from 'swr'

const uid: Key = '<user_id>'
const fetcher: Fetcher<string, User> = (id) => getUserById(id)

const { data } = useSWR(uid, fetcher)
// `data` å°†ä¼šæ˜¯ `User | undefined`.
```

### useSWRInfinite

åŒæ ·é€‚ç”¨äº `swr/inifite`ï¼Œä½ å¯ä»¥ä¾é è‡ªåŠ¨ç±»å‹æ¨æ–­æˆ–è‡ªå·±æ˜¾å¼åœ°æŒ‡å®šç±»å‹ã€‚

```typescript
import { SWRInfiniteKeyLoader } from 'swr/infinite'

const getKey: SWRInfiniteKeyLoader = (index, previousPageData) => {
  // ...
}

const { data } = useSWRInfinite(getKey, fetcher)
```

## Generics

æŒ‡å®š `data` çš„ç±»å‹å¾ˆå®¹æ˜“ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå°†ä½¿ç”¨ `fetcher` çš„è¿”å›ç±»å‹ï¼ˆæœªå°±ç»ªçŠ¶æ€ä¸º `undefined`ï¼‰ä½œä¸º `data` çš„ç±»å‹ï¼Œä½†ä½ ä¹Ÿå¯ä»¥å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ï¼š

```typescript
// ğŸ”¹ A. Use a typed fetcher:
// `getUser` is `(endpoint: string) => User`.
const { data } = useSWR('/api/user', getUser)

// ğŸ”¹ B. Specify the data type:
// `fetcher` is generally returning `any`.
const { data } = useSWR<User>('/api/user', fetcher)
```

å¦‚æœè¦ä¸º SWR çš„å…¶ä»–é€‰é¡¹æ·»åŠ ç±»å‹ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥å¯¼å…¥è¿™äº›ç±»å‹ï¼š

```typescript
import useSWR from 'swr'
import type { SWRConfiguration } from 'swr'

const config: SWRConfiguration = {
  fallbackData: "fallback",
  revalidateOnMount: false
  // ...
}

const { data } = useSWR<string[]>('/api/data', fetcher, config)
```

## Middleware Types

ä½ å¯ä»¥å¯¼å…¥ä¸€äº›é¢å¤–çš„ç±»å‹å®šä¹‰ï¼Œä»¥å¸®åŠ©ä½ å‘è‡ªå®šä¹‰çš„ä¸­é—´ä»¶æ·»åŠ ç±»å‹ã€‚

```typescript
import useSWR, { Middleware, SWRHook } from 'swr'

const swrMiddleware: Middleware = (useSWRNext: SWRHook) => (key, fetcher, config) => {
  // ...
  return useSWRNext(key, fetcher, config)
}
```
