import Callout from 'nextra-theme-docs/callout'
import Link from 'next/link'

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏ [`fetcher`-–∞](/docs/data-fetching), –æ–Ω–∞ –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ —Ö—É–∫–æ–º –∫–∞–∫ `error`.

```js
const fetcher = url => fetch(url).then(r => r.json())

// ...
const { data, error } = useSWR('/api/user', fetcher)
```

–û–±—ä–µ–∫—Ç `error` –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –µ—Å–ª–∏ –ø—Ä–æ–º–∏—Å –≤—ã–±–æ—Ä–∫–∏ –±—É–¥–µ—Ç –æ—Ç–∫–ª–æ–Ω—ë–Ω.

## –°—Ç–∞—Ç—É—Å –∫–æ–¥ –∏ –û–±—ä–µ–∫—Ç –æ—à–∏–±–∫–∏

–ò–Ω–æ–≥–¥–∞ –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã API –≤–æ–∑–≤—Ä–∞—â–∞–ª –æ–±—ä–µ–∫—Ç –æ—à–∏–±–∫–∏ –≤–º–µ—Å—Ç–µ —Å–æ —Å—Ç–∞—Ç—É—Å –∫–æ–¥–æ–º. –û–±–∞ –æ–Ω–∏ –ø–æ–ª–µ–∑–Ω—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞.

–ú—ã –º–æ–∂–µ–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞—à `fetcher`, —á—Ç–æ–±—ã –æ–Ω –≤–æ–∑–≤—Ä–∞—â–∞–ª –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –∫–æ–¥ –Ω–µ `2xx`,
–º—ã —Å—á–∏—Ç–∞–µ–º —ç—Ç–æ –æ—à–∏–±–∫–æ–π, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ JSON:

```js
const fetcher = async url => {
  const res = await fetch(url)

  // –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –∫–æ–¥ –Ω–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 200-299,
  // –º—ã –≤—Å–µ —Ä–∞–≤–Ω–æ –ø—ã—Ç–∞–µ–º—Å—è –µ–≥–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å –∏ –≤—ã–±—Ä–æ—Å–∏—Ç—å.
  if (!res.ok) {
    const error = new Error('An error occurred while fetching the data.')
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –æ–±—ä–µ–∫—Ç –æ—à–∏–±–∫–∏.
    error.info = await res.json()
    error.status = res.status
    throw error
  }

  return res.json()
}

// ...
const { data, error } = useSWR('/api/user', fetcher)
// error.info === {
//   message: "–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —Ä–µ—Å—É—Ä—Å—É.",
//   documentation_url: "..."
// }
// error.status === 403
```

<Callout emoji="üí°">
  –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ <code>data</code> –∏ <code>error</code> –º–æ–≥—É—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. 
  –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ, –∑–Ω–∞—è, 
  —á—Ç–æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–π –∑–∞–ø—Ä–æ—Å –ø–æ—Ç–µ—Ä–ø–µ–ª –Ω–µ—É–¥–∞—á—É.
</Callout>

[–ó–¥–µ—Å—å](/examples/error-handling) —É –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–∏–º–µ—Ä.

## –ü–æ–≤—Ç–æ—Ä –ø—Ä–∏ –æ—à–∏–±–∫–µ

SWR –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [–∞–ª–≥–æ—Ä–∏—Ç–º —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –≤—ã–¥–µ—Ä–∂–∫–∏](https://ru.wikipedia.org/wiki/–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è_–≤—ã–¥–µ—Ä–∂–∫–∞) –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏.
–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –±—ã—Å—Ç—Ä–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫, –Ω–æ –Ω–µ —Ç—Ä–∞—Ç–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ.

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –æ–ø—Ü–∏–∏ [onErrorRetry](/docs/options#–æ–ø—Ü–∏–∏):

```js
useSWR('/api/user', fetcher, {
  onErrorRetry: (error, key, config, revalidate, { retryCount }) => {
    // –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–π—Ç–µ –ø–æ–ø—ã—Ç–∫—É –ø—Ä–∏ 404.
    if (error.status === 404) return

    // –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–π—Ç–µ –ø–æ–ø—ã—Ç–∫—É –ø—Ä–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –∫–ª—é—á–µ.
    if (key === '/api/user') return

    // –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É –¥–æ 10 —Ä–∞–∑.
    if (retryCount >= 10) return

    // –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥.
    setTimeout(() => revalidate({ retryCount }), 5000)
  }
})
```

–≠—Ç–æ—Ç –∫–æ–ª–±—ç–∫ –¥–∞–µ—Ç –≤–∞–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π. –í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å –µ–≥–æ, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ `shouldRetryOnError: false`.

–¢–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç [–ì–ª–æ–±–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏](/docs/global-configuration).

## –û—Ç—á—ë—Ç –æ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ—à–∏–±–∫–µ

–í—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç `error` –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.
–ù–æ –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É –≥–ª–æ–±–∞–ª—å–Ω–æ, —á—Ç–æ–±—ã —É–≤–µ–¥–æ–º–∏—Ç—å UI,
—á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å [toast](https://vercel.com/design/toast) –∏–ª–∏ [snackbar](https://material.io/components/snackbars),
–∏–ª–∏ —Å–æ–æ–±—â–∏—Ç—å –æ–± —ç—Ç–æ–º –∫—É–¥–∞-–Ω–∏–±—É–¥—å, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ [Sentry](https://sentry.io),
–µ—Å—Ç—å —Å–æ–±—ã—Ç–∏–µ [`onError`](/docs/options#–æ–ø—Ü–∏–∏):

```jsx
<SWRConfig value={{
  onError: (error, key) => {
    if (error.status !== 403 && error.status !== 404) {
      // –ú—ã –º–æ–∂–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É –≤ Sentry,
      // –∏–ª–∏ –ø–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ UI.
    }
  }
}}>
  <MyApp />
</SWRConfig>
```
